# TextDrive - Rust版

C版のTextDriveをRustで再実装したプロジェクトです。Q学習を使用したAIによる自動運転機能を備えています。

## 機能

- ASCII文字による縦スクロール型ドライビングゲーム
- 手動プレイモード
- Q学習AIによる自動プレイモード
- AIの学習・訓練機能

## プロジェクト構成

```
textdrive-rust/
├── src/
│   ├── lib.rs           # ライブラリのエントリーポイント
│   ├── game.rs          # ゲームロジック
│   ├── qlearning.rs     # Q学習の実装
│   ├── error.rs         # カスタムエラー型
│   └── bin/
│       ├── textdrive.rs # メインゲーム
│       └── train.rs     # 学習プログラム
├── Cargo.toml
└── README.md
```

## ビルド

```bash
cargo build --release
```

## 使用方法

### AIの訓練

```bash
cargo run --release --bin train
```

50,000エピソードを学習し、`qtable.bin` ファイルにQ値を保存します。

### ゲームをプレイ

#### 手動プレイ
```bash
cargo run --release --bin textdrive
```

#### AIプレイ
```bash
cargo run --release --bin textdrive ai
```

## 操作方法

- **左右矢印キー** または **A/D**: プレイヤーを左右に移動
- **M**: AIモードと手動モードを切り替え（qtable.binが必要）
- **R**: ゲームをリスタート
- **Q**: 終了

## アーキテクチャの特徴

### 型安全性

- `Cell` enum: セルの状態（空 or 壁）を型安全に表現
- `Direction` enum: 移動方向を型安全に表現
- `Action` enum: AI の行動を型安全に表現

### エラーハンドリング

- カスタム `GameError` 型による明確なエラーハンドリング
- `Result<T>` 型エイリアスの使用

### モジュラー設計

- ゲームロジックとQ学習の実装を分離
- 各モジュールは独立してテスト可能

### ドキュメント

- 全ての公開API にドキュメントコメントを付与
- `cargo doc --open` でドキュメントを生成・閲覧可能

## Q学習パラメータ

- **学習率 (α)**: 0.2
- **割引率 (γ)**: 0.95
- **ε減衰率**: 0.9995
- **状態空間サイズ**: 32,768 (2^15)
- **行動数**: 3 (左, 待機, 右)
- **視野**: プレイヤーの前方3行、左右2列

## 報酬設計

- **生存**: +1
- **衝突**: -100

## 依存関係

- `rand`: 乱数生成
- `pancurses`: ターミナルUI

## ライセンス

このプロジェクトはオープンソースです。
